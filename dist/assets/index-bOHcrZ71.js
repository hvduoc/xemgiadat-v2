(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();(function(){console.log("[INIT] Extended utilities loading..."),window.__CDN_LOAD_STATUS__||(window.__CDN_LOAD_STATUS__={},window.__trackCDN=function(i,n){window.__CDN_LOAD_STATUS__[i]=n,console.log("[CDN] "+i+": "+(n?"✓ OK":"✗ FAILED"))});function r(){window.__REAL_LOCATION__||(window.__REAL_LOCATION__={href:window.location.href,origin:window.location.origin,protocol:window.location.protocol,host:window.location.host,hostname:window.location.hostname,pathname:window.location.pathname,search:window.location.search,hash:window.location.hash,toString:function(){return window.location.href}});var i={href:"https://xemgiadat.com/",origin:"https://xemgiadat.com",protocol:"https:",host:"xemgiadat.com",hostname:"xemgiadat.com",pathname:"/",search:"",hash:"",toString:function(){return"https://xemgiadat.com/"}};try{var n=["href","origin","protocol","host","hostname","pathname","search","hash"];n.forEach(function(o){Object.defineProperty(window.location,o,{get:function(){return i[o]},configurable:!0})}),console.log("[INIT] ✓ window.location override successful")}catch(o){window.__SAFE_LOCATION__=i,console.warn("[INIT] window.location override failed, using fallback:",o.message)}}r();var e={apiKey:"AIzaSyDu9tYpJdMPT7Hvk2_Ug8XHwxRQXoakRfs",authDomain:"xemgiadat-dfe15.firebaseapp.com",projectId:"xemgiadat-dfe15",storageBucket:"xemgiadat-dfe15.appspot.com",messagingSenderId:"361952598367",appId:"1:361952598367:web:c1e2e3b1a6d5d8c797beea",measurementId:"G-XT932D9N1N"},t=null;window.__initFirebase=function(){return t||(t=(async function(){if(!window.firebase)throw new Error("Firebase SDK not available");(!window.firebase.apps||window.firebase.apps.length===0)&&window.firebase.initializeApp(e);var i=window.firebase.auth(),n=window.firebase.firestore(),o=window.firebase.storage();if(window.firebase.analytics)try{window.firebase.analytics()}catch(a){console.warn("[Firebase] Analytics init skipped:",(a==null?void 0:a.message)||a)}return window.__firebaseAuth=i,window.__firebaseDb=n,window.__firebaseStorage=o,{auth:i,db:n,storage:o}})(),t)},window.__ensureUserDocument=async function(i){var f,u;var n=window.__firebaseDb;if(!(!n||!i)){var o=n.collection("users").doc(i.uid),a=await o.get(),s=window.firebase.firestore.FieldValue.serverTimestamp();a.exists?await o.update({updatedAt:s,displayName:i.displayName||((f=a.data())==null?void 0:f.displayName)||"",photoURL:i.photoURL||((u=a.data())==null?void 0:u.photoURL)||""}):await o.set({displayName:i.displayName||"",email:i.email||"",phone:"",contactFacebook:"",photoURL:i.photoURL||"",createdAt:s,updatedAt:s})}},window.__initFirebaseUi=function(i){if(!window.firebaseui||!window.firebase)return console.error("[FirebaseUI] SDK not available"),null;var n={callbacks:{signInSuccessWithAuthResult:function(o,a){return console.log("[Auth] Sign in success:",o.user.email),!1},signInFailure:function(o){return console.warn("[Auth] Sign in failed:",o),Promise.resolve()}},signInFlow:"popup",credentialHelper:window.firebaseui.auth.CredentialHelper.NONE,signInOptions:[window.firebase.auth.GoogleAuthProvider.PROVIDER_ID,window.firebase.auth.FacebookAuthProvider.PROVIDER_ID,window.firebase.auth.EmailAuthProvider.PROVIDER_ID],tosUrl:"#",privacyPolicyUrl:"#"};return window.__firebaseUiInstance||(window.__firebaseUiInstance=new window.firebaseui.auth.AuthUI(window.firebase.auth())),window.__firebaseUiInstance.start(i,n),window.__firebaseUiInstance},console.log("[INIT] ✓ Core utilities initialized")})();var _=Uint8Array,S=Uint16Array,Je=Int32Array,Te=new _([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xe=new _([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),qe=new _([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ee=function(r,e){for(var t=new S(31),i=0;i<31;++i)t[i]=e+=1<<r[i-1];for(var n=new Je(t[30]),i=1;i<30;++i)for(var o=t[i];o<t[i+1];++o)n[o]=o-t[i]<<5|i;return{b:t,r:n}},Ue=Ee(Te,2),Le=Ue.b,Xe=Ue.r;Le[28]=258,Xe[258]=28;var Qe=Ee(xe,0),Ye=Qe.b,Q=new S(32768);for(var g=0;g<32768;++g){var C=(g&43690)>>1|(g&21845)<<1;C=(C&52428)>>2|(C&13107)<<2,C=(C&61680)>>4|(C&3855)<<4,Q[g]=((C&65280)>>8|(C&255)<<8)>>1}var M=(function(r,e,t){for(var i=r.length,n=0,o=new S(e);n<i;++n)r[n]&&++o[r[n]-1];var a=new S(e);for(n=1;n<e;++n)a[n]=a[n-1]+o[n-1]<<1;var s;if(t){s=new S(1<<e);var f=15-e;for(n=0;n<i;++n)if(r[n])for(var u=n<<4|r[n],c=e-r[n],l=a[r[n]-1]++<<c,h=l|(1<<c)-1;l<=h;++l)s[Q[l]>>f]=u}else for(s=new S(i),n=0;n<i;++n)r[n]&&(s[n]=Q[a[r[n]-1]++]>>15-r[n]);return s}),N=new _(288);for(var g=0;g<144;++g)N[g]=8;for(var g=144;g<256;++g)N[g]=9;for(var g=256;g<280;++g)N[g]=7;for(var g=280;g<288;++g)N[g]=8;var Ae=new _(32);for(var g=0;g<32;++g)Ae[g]=5;var et=M(N,9,1),tt=M(Ae,5,1),q=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},x=function(r,e,t){var i=e/8|0;return(r[i]|r[i+1]<<8)>>(e&7)&t},X=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},rt=function(r){return(r+7)/8|0},it=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new _(r.subarray(e,t))},nt=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],b=function(r,e,t){var i=new Error(e||nt[r]);if(i.code=r,Error.captureStackTrace&&Error.captureStackTrace(i,b),!t)throw i;return i},te=function(r,e,t,i){var n=r.length,o=0;if(!n||e.f&&!e.l)return t||new _(0);var a=!t,s=a||e.i!=2,f=e.i;a&&(t=new _(n*3));var u=function(pe){var ye=t.length;if(pe>ye){var be=new _(Math.max(ye*2,pe));be.set(t),t=be}},c=e.f||0,l=e.p||0,h=e.b||0,p=e.l,m=e.d,w=e.m,E=e.n,B=n*8;do{if(!p){c=x(r,l,1);var Z=x(r,l+1,3);if(l+=3,Z)if(Z==1)p=et,m=tt,w=9,E=5;else if(Z==2){var j=x(r,l,31)+257,ue=x(r,l+10,15)+4,he=j+x(r,l+5,31)+1;l+=14;for(var O=new _(he),V=new _(19),T=0;T<ue;++T)V[qe[T]]=x(r,l+T*3,7);l+=ue*3;for(var fe=q(V),Ke=(1<<fe)-1,je=M(V,fe,1),T=0;T<he;){var de=je[x(r,l,Ke)];l+=de&15;var U=de>>4;if(U<16)O[T++]=U;else{var D=0,F=0;for(U==16?(F=3+x(r,l,3),l+=2,D=O[T-1]):U==17?(F=3+x(r,l,7),l+=3):U==18&&(F=11+x(r,l,127),l+=7);F--;)O[T++]=D}}var ge=O.subarray(0,j),A=O.subarray(j);w=q(ge),E=q(A),p=M(ge,w,1),m=M(A,E,1)}else b(1);else{var U=rt(l)+4,$=r[U-4]|r[U-3]<<8,K=U+$;if(K>n){f&&b(0);break}s&&u(h+$),t.set(r.subarray(U,K),h),e.b=h+=$,e.p=l=K*8,e.f=c;continue}if(l>B){f&&b(0);break}}s&&u(h+131072);for(var Ve=(1<<w)-1,We=(1<<E)-1,W=l;;W=l){var D=p[X(r,l)&Ve],P=D>>4;if(l+=D&15,l>B){f&&b(0);break}if(D||b(2),P<256)t[h++]=P;else if(P==256){W=l,p=null;break}else{var me=P-254;if(P>264){var T=P-257,R=Te[T];me=x(r,l,(1<<R)-1)+Le[T],l+=R}var G=m[X(r,l)&We],J=G>>4;G||b(3),l+=G&15;var A=Ye[J];if(J>3){var R=xe[J];A+=X(r,l)&(1<<R)-1,l+=R}if(l>B){f&&b(0);break}s&&u(h+131072);var we=h+me;if(h<A){var ve=o-A,Ge=Math.min(A,we);for(ve+h<0&&b(3);h<Ge;++h)t[h]=i[ve+h]}for(;h<we;++h)t[h]=t[h-A]}}e.l=p,e.p=W,e.b=h,e.f=c,p&&(c=1,e.m=w,e.d=m,e.n=E)}while(!c);return h!=t.length&&a?it(t,0,h):t.subarray(0,h)},ot=new _(0),at=function(r){(r[0]!=31||r[1]!=139||r[2]!=8)&&b(6,"invalid gzip data");var e=r[3],t=10;e&4&&(t+=(r[10]|r[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!r[t++]);return t+(e&2)},st=function(r){var e=r.length;return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0},lt=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&b(6,"invalid zlib data"),(r[1]>>5&1)==1&&b(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function ct(r,e){return te(r,{i:2},e,e)}function ut(r,e){var t=at(r);return t+8>r.length&&b(6,"invalid gzip data"),te(r.subarray(t,-8),{i:2},new _(st(r)),e)}function ht(r,e){return te(r.subarray(lt(r),-4),{i:2},e,e)}function ft(r,e){return r[0]==31&&r[1]==139&&r[2]==8?ut(r,e):(r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31?ct(r,e):ht(r,e)}var dt=typeof TextDecoder<"u"&&new TextDecoder,gt=0;try{dt.decode(ot,{stream:!0}),gt=1}catch{}var mt=Object.defineProperty,z=Math.pow,d=(r,e)=>mt(r,"name",{value:e,configurable:!0}),v=(r,e,t)=>new Promise((i,n)=>{var o=f=>{try{s(t.next(f))}catch(u){n(u)}},a=f=>{try{s(t.throw(f))}catch(u){n(u)}},s=f=>f.done?i(f.value):Promise.resolve(f.value).then(o,a);s((t=t.apply(r,e)).next())}),wt=d((r,e)=>{let t=!1,i="",n=L.GridLayer.extend({createTile:d((o,a)=>{let s=document.createElement("img"),f=new AbortController,u=f.signal;return s.cancel=()=>{f.abort()},t||(r.getHeader().then(c=>{c.tileType===1?console.error("Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details."):c.tileType===2?i="image/png":c.tileType===3?i="image/jpeg":c.tileType===4?i="image/webp":c.tileType===5&&(i="image/avif")}),t=!0),r.getZxy(o.z,o.x,o.y,u).then(c=>{if(c){let l=new Blob([c.data],{type:i}),h=window.URL.createObjectURL(l);s.src=h,s.cancel=void 0,a(void 0,s)}}).catch(c=>{if(c.name!=="AbortError")throw c}),s},"createTile"),_removeTile:d(function(o){let a=this._tiles[o];a&&(a.el.cancel&&a.el.cancel(),a.el.width=0,a.el.height=0,a.el.deleted=!0,L.DomUtil.remove(a.el),delete this._tiles[o],this.fire("tileunload",{tile:a.el,coords:this._keyToTileCoords(o)}))},"_removeTile")});return new n(e)},"leafletRasterLayer"),vt=d(r=>(e,t)=>{if(t instanceof AbortController)return r(e,t);let i=new AbortController;return r(e,i).then(n=>t(void 0,n.data,n.cacheControl||"",n.expires||""),n=>t(n)).catch(n=>t(n)),{cancel:d(()=>i.abort(),"cancel")}},"v3compat"),Ce=class{constructor(e){this.tilev4=d((t,i)=>v(this,null,function*(){if(t.type==="json"){let p=t.url.substr(10),m=this.tiles.get(p);if(m||(m=new ee(p),this.tiles.set(p,m)),this.metadata)return{data:yield m.getTileJson(t.url)};let w=yield m.getHeader();return{data:{tiles:[`${t.url}/{z}/{x}/{y}`],minzoom:w.minZoom,maxzoom:w.maxZoom,bounds:[w.minLon,w.minLat,w.maxLon,w.maxLat]}}}let n=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),o=t.url.match(n);if(!o)throw new Error("Invalid PMTiles protocol URL");let a=o[1],s=this.tiles.get(a);s||(s=new ee(a),this.tiles.set(a,s));let f=o[2],u=o[3],c=o[4],l=yield s.getHeader(),h=yield s==null?void 0:s.getZxy(+f,+u,+c,i.signal);return h?{data:new Uint8Array(h.data),cacheControl:h.cacheControl,expires:h.expires}:l.tileType===1?{data:new Uint8Array}:{data:null}}),"tilev4"),this.tile=vt(this.tilev4),this.tiles=new Map,this.metadata=(e==null?void 0:e.metadata)||!1}add(e){this.tiles.set(e.source.getKey(),e)}get(e){return this.tiles.get(e)}};d(Ce,"Protocol");var Y=Ce;function Ie(r,e){return(e>>>0)*4294967296+(r>>>0)}d(Ie,"toNum");function De(r,e){let t=e.buf,i=t[e.pos++],n=(i&112)>>4;if(i<128||(i=t[e.pos++],n|=(i&127)<<3,i<128)||(i=t[e.pos++],n|=(i&127)<<10,i<128)||(i=t[e.pos++],n|=(i&127)<<17,i<128)||(i=t[e.pos++],n|=(i&127)<<24,i<128)||(i=t[e.pos++],n|=(i&1)<<31,i<128))return Ie(r,n);throw new Error("Expected varint not more than 10 bytes")}d(De,"readVarintRemainder");function I(r){let e=r.buf,t=e[r.pos++],i=t&127;return t<128||(t=e[r.pos++],i|=(t&127)<<7,t<128)||(t=e[r.pos++],i|=(t&127)<<14,t<128)||(t=e[r.pos++],i|=(t&127)<<21,t<128)?i:(t=e[r.pos],i|=(t&15)<<28,De(i,r))}d(I,"readVarint");function re(r,e,t,i){if(i===0){t===1&&(e[0]=r-1-e[0],e[1]=r-1-e[1]);let n=e[0];e[0]=e[1],e[1]=n}}d(re,"rotate");function Pe(r,e){let t=z(2,r),i=e,n=e,o=e,a=[0,0],s=1;for(;s<t;)i=1&o/2,n=1&(o^i),re(s,a,i,n),a[0]+=s*i,a[1]+=s*n,o=o/4,s*=2;return[r,a[0],a[1]]}d(Pe,"idOnLevel");var pt=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function ie(r,e,t){if(r>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>z(2,r)-1||t>z(2,r)-1)throw Error("tile x/y outside zoom level bounds");let i=pt[r],n=z(2,r),o=0,a=0,s=0,f=[e,t],u=n/2;for(;u>0;)o=(f[0]&u)>0?1:0,a=(f[1]&u)>0?1:0,s+=u*u*(3*o^a),re(u,f,o,a),u=u/2;return i+s}d(ie,"zxyToTileId");function Se(r){let e=0;for(let t=0;t<27;t++){let i=(1<<t)*(1<<t);if(e+i>r)return Pe(t,r-e);e+=i}throw Error("Tile zoom level exceeds max safe number limit (26)")}d(Se,"tileIdToZxy");var Oe=(r=>(r[r.Unknown=0]="Unknown",r[r.None=1]="None",r[r.Gzip=2]="Gzip",r[r.Brotli=3]="Brotli",r[r.Zstd=4]="Zstd",r))(Oe||{});function H(r,e){return v(this,null,function*(){if(e===1||e===0)return r;if(e===2){if(typeof globalThis.DecompressionStream>"u")return ft(new Uint8Array(r));let t=new Response(r).body;if(!t)throw Error("Failed to read response stream");let i=t.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(i).arrayBuffer()}throw Error("Compression method not supported")})}d(H,"defaultDecompress");var Re=(r=>(r[r.Unknown=0]="Unknown",r[r.Mvt=1]="Mvt",r[r.Png=2]="Png",r[r.Jpeg=3]="Jpeg",r[r.Webp=4]="Webp",r[r.Avif=5]="Avif",r))(Re||{});function ne(r){return r===1?".mvt":r===2?".png":r===3?".jpg":r===4?".webp":r===5?".avif":""}d(ne,"tileTypeExt");var yt=127;function oe(r,e){let t=0,i=r.length-1;for(;t<=i;){let n=i+t>>1,o=e-r[n].tileId;if(o>0)t=n+1;else if(o<0)i=n-1;else return r[n]}return i>=0&&(r[i].runLength===0||e-r[i].tileId<r[i].runLength)?r[i]:null}d(oe,"findTile");var Me=class{constructor(e){this.file=e}getKey(){return this.file.name}getBytes(e,t){return v(this,null,function*(){return{data:yield this.file.slice(e,e+t).arrayBuffer()}})}};d(Me,"FileSource");var bt=Me,ze=class{constructor(e,t=new Headers){this.url=e,this.customHeaders=t,this.mustReload=!1;let i="";"navigator"in globalThis&&(i=globalThis.navigator.userAgent||"");let n=i.indexOf("Windows")>-1,o=/Chrome|Chromium|Edg|OPR|Brave/.test(i);this.chromeWindowsNoCache=!1,n&&o&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(e){this.customHeaders=e}getBytes(e,t,i,n){return v(this,null,function*(){let o,a;i?a=i:(o=new AbortController,a=o.signal);let s=new Headers(this.customHeaders);s.set("range",`bytes=${e}-${e+t-1}`);let f;this.mustReload?f="reload":this.chromeWindowsNoCache&&(f="no-store");let u=yield fetch(this.url,{signal:a,cache:f,headers:s});if(e===0&&u.status===416){let h=u.headers.get("Content-Range");if(!h||!h.startsWith("bytes */"))throw Error("Missing content-length on 416 response");let p=+h.substr(8);u=yield fetch(this.url,{signal:a,cache:"reload",headers:{range:`bytes=0-${p-1}`}})}let c=u.headers.get("Etag");if(c!=null&&c.startsWith("W/")&&(c=null),u.status===416||n&&c&&c!==n)throw this.mustReload=!0,new k(`Server returned non-matching ETag ${n} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(u.status>=300)throw Error(`Bad response code: ${u.status}`);let l=u.headers.get("Content-Length");if(u.status===200&&(!l||+l>t))throw o&&o.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield u.arrayBuffer(),etag:c||void 0,cacheControl:u.headers.get("Cache-Control")||void 0,expires:u.headers.get("Expires")||void 0}})}};d(ze,"FetchSource");var Ne=ze;function y(r,e){let t=r.getUint32(e+4,!0),i=r.getUint32(e+0,!0);return t*z(2,32)+i}d(y,"getUint64");function ae(r,e){let t=new DataView(r),i=t.getUint8(7);if(i>3)throw Error(`Archive is spec version ${i} but this library supports up to spec version 3`);return{specVersion:i,rootDirectoryOffset:y(t,8),rootDirectoryLength:y(t,16),jsonMetadataOffset:y(t,24),jsonMetadataLength:y(t,32),leafDirectoryOffset:y(t,40),leafDirectoryLength:y(t,48),tileDataOffset:y(t,56),tileDataLength:y(t,64),numAddressedTiles:y(t,72),numTileEntries:y(t,80),numTileContents:y(t,88),clustered:t.getUint8(96)===1,internalCompression:t.getUint8(97),tileCompression:t.getUint8(98),tileType:t.getUint8(99),minZoom:t.getUint8(100),maxZoom:t.getUint8(101),minLon:t.getInt32(102,!0)/1e7,minLat:t.getInt32(106,!0)/1e7,maxLon:t.getInt32(110,!0)/1e7,maxLat:t.getInt32(114,!0)/1e7,centerZoom:t.getUint8(118),centerLon:t.getInt32(119,!0)/1e7,centerLat:t.getInt32(123,!0)/1e7,etag:e}}d(ae,"bytesToHeader");function se(r){let e={buf:new Uint8Array(r),pos:0},t=I(e),i=[],n=0;for(let o=0;o<t;o++){let a=I(e);i.push({tileId:n+a,offset:0,length:0,runLength:1}),n+=a}for(let o=0;o<t;o++)i[o].runLength=I(e);for(let o=0;o<t;o++)i[o].length=I(e);for(let o=0;o<t;o++){let a=I(e);a===0&&o>0?i[o].offset=i[o-1].offset+i[o-1].length:i[o].offset=a-1}return i}d(se,"deserializeIndex");var Fe=class extends Error{};d(Fe,"EtagMismatch");var k=Fe;function le(r,e){return v(this,null,function*(){let t=yield r.getBytes(0,16384);if(new DataView(t.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");let i=t.data.slice(0,yt),n=ae(i,t.etag),o=t.data.slice(n.rootDirectoryOffset,n.rootDirectoryOffset+n.rootDirectoryLength),a=`${r.getKey()}|${n.etag||""}|${n.rootDirectoryOffset}|${n.rootDirectoryLength}`,s=se(yield e(o,n.internalCompression));return[n,[a,s.length,s]]})}d(le,"getHeaderAndRoot");function ce(r,e,t,i,n){return v(this,null,function*(){let o=yield r.getBytes(t,i,void 0,n.etag),a=yield e(o.data,n.internalCompression),s=se(a);if(s.length===0)throw new Error("Empty directory is invalid");return s})}d(ce,"getDirectory");var ke=class{constructor(e=100,t=!0,i=H){this.cache=new Map,this.maxCacheEntries=e,this.counter=1,this.decompress=i}getHeader(e){return v(this,null,function*(){let t=e.getKey(),i=this.cache.get(t);if(i)return i.lastUsed=this.counter++,i.data;let n=yield le(e,this.decompress);return n[1]&&this.cache.set(n[1][0],{lastUsed:this.counter++,data:n[1][2]}),this.cache.set(t,{lastUsed:this.counter++,data:n[0]}),this.prune(),n[0]})}getDirectory(e,t,i,n){return v(this,null,function*(){let o=`${e.getKey()}|${n.etag||""}|${t}|${i}`,a=this.cache.get(o);if(a)return a.lastUsed=this.counter++,a.data;let s=yield ce(e,this.decompress,t,i,n);return this.cache.set(o,{lastUsed:this.counter++,data:s}),this.prune(),s})}prune(){if(this.cache.size>this.maxCacheEntries){let e=1/0,t;this.cache.forEach((i,n)=>{i.lastUsed<e&&(e=i.lastUsed,t=n)}),t&&this.cache.delete(t)}}invalidate(e){return v(this,null,function*(){this.cache.delete(e.getKey())})}};d(ke,"ResolvedValueCache");var _t=ke,He=class{constructor(e=100,t=!0,i=H){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=e,this.counter=1,this.decompress=i}getHeader(e){return v(this,null,function*(){let t=e.getKey(),i=this.cache.get(t);if(i)return i.lastUsed=this.counter++,yield i.data;let n=new Promise((o,a)=>{le(e,this.decompress).then(s=>{s[1]&&this.cache.set(s[1][0],{lastUsed:this.counter++,data:Promise.resolve(s[1][2])}),o(s[0]),this.prune()}).catch(s=>{a(s)})});return this.cache.set(t,{lastUsed:this.counter++,data:n}),n})}getDirectory(e,t,i,n){return v(this,null,function*(){let o=`${e.getKey()}|${n.etag||""}|${t}|${i}`,a=this.cache.get(o);if(a)return a.lastUsed=this.counter++,yield a.data;let s=new Promise((f,u)=>{ce(e,this.decompress,t,i,n).then(c=>{f(c),this.prune()}).catch(c=>{u(c)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let e=1/0,t;this.cache.forEach((i,n)=>{i.lastUsed<e&&(e=i.lastUsed,t=n)}),t&&this.cache.delete(t)}}invalidate(e){return v(this,null,function*(){let t=e.getKey();if(this.invalidations.get(t))return yield this.invalidations.get(t);this.cache.delete(e.getKey());let i=new Promise((n,o)=>{this.getHeader(e).then(a=>{n(),this.invalidations.delete(t)}).catch(a=>{o(a)})});this.invalidations.set(t,i)})}};d(He,"SharedPromiseCache");var Be=He,Ze=class{constructor(e,t,i){typeof e=="string"?this.source=new Ne(e):this.source=e,i?this.decompress=i:this.decompress=H,t?this.cache=t:this.cache=new Be}getHeader(){return v(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(e,t,i,n){return v(this,null,function*(){let o=ie(e,t,i),a=yield this.cache.getHeader(this.source);if(e<a.minZoom||e>a.maxZoom)return;let s=a.rootDirectoryOffset,f=a.rootDirectoryLength;for(let u=0;u<=3;u++){let c=yield this.cache.getDirectory(this.source,s,f,a),l=oe(c,o);if(l){if(l.runLength>0){let h=yield this.source.getBytes(a.tileDataOffset+l.offset,l.length,n,a.etag);return{data:yield this.decompress(h.data,a.tileCompression),cacheControl:h.cacheControl,expires:h.expires}}s=a.leafDirectoryOffset+l.offset,f=l.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(e,t,i,n){return v(this,null,function*(){try{return yield this.getZxyAttempt(e,t,i,n)}catch(o){if(o instanceof k)return this.cache.invalidate(this.source),yield this.getZxyAttempt(e,t,i,n);throw o}})}getMetadataAttempt(){return v(this,null,function*(){let e=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength,void 0,e.etag),i=yield this.decompress(t.data,e.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(i))})}getMetadata(){return v(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(e){if(e instanceof k)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw e}})}getTileJson(e){return v(this,null,function*(){let t=yield this.getHeader(),i=yield this.getMetadata(),n=ne(t.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${e}/{z}/{x}/{y}${n}`],vector_layers:i.vector_layers,attribution:i.attribution,description:i.description,name:i.name,version:i.version,bounds:[t.minLon,t.minLat,t.maxLon,t.maxLat],center:[t.centerLon,t.centerLat,t.centerZoom],minzoom:t.minZoom,maxzoom:t.maxZoom}})}};d(Ze,"PMTiles");var ee=Ze;const $e=Object.freeze(Object.defineProperty({__proto__:null,Compression:Oe,EtagMismatch:k,FetchSource:Ne,FileSource:bt,PMTiles:ee,Protocol:Y,ResolvedValueCache:_t,SharedPromiseCache:Be,TileType:Re,bytesToHeader:ae,findTile:oe,getUint64:y,leafletRasterLayer:wt,readVarint:I,tileIdToZxy:Se,tileTypeExt:ne,zxyToTileId:ie},Symbol.toStringTag,{value:"Module"}));window.pmtiles=$e;window.__trackCDN("pmtiles",!0);console.log("[PMTiles] ✓ Loaded via ES module:",$e);if(window.maplibregl){const r=new Y;window.maplibregl.addProtocol("pmtiles",r.tile),window.__pmtiles_registered=!0,console.log("[PMTiles] ✓ Protocol registered")}else{const r=setInterval(()=>{if(window.maplibregl){clearInterval(r);const e=new Y;window.maplibregl.addProtocol("pmtiles",e.tile),window.__pmtiles_registered=!0,console.log("[PMTiles] ✓ Protocol registered (delayed)")}},100)}const Tt="modulepreload",xt=function(r,e){return new URL(r,e).href},_e={},Et=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){let a=function(c){return Promise.all(c.map(l=>Promise.resolve(l).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};const s=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),u=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));n=a(t.map(c=>{if(c=xt(c,i),c in _e)return;_e[c]=!0;const l=c.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(!!i)for(let w=s.length-1;w>=0;w--){const E=s[w];if(E.href===c&&(!l||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=l?"stylesheet":Tt,l||(m.as="script"),m.crossOrigin="",m.href=c,u&&m.setAttribute("nonce",u),document.head.appendChild(m),l)return new Promise((w,E)=>{m.addEventListener("load",w),m.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return n.then(a=>{for(const s of a||[])s.status==="rejected"&&o(s.reason);return e().catch(o)})};Et(()=>import("./index-Ty-xXZpf.js"),[],import.meta.url).catch(r=>{console.error("[App] Failed to load app:",r)});
